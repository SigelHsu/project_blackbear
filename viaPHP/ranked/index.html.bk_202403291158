<html>
	<head>
		<!-- https://www.hitthebits.com/2012/05/animating-list-with-css3-transitions.html -->
		
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-wEmeIV1mKuiNpC+IOBjI7aAzPcEZeedi5yW5f2yOq55WWLwNGmvvx4Um1vskeMj0" crossorigin="anonymous">
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-p34f1UUtsS3wqzfto5wAAmdvj+osOnFyQFpp4Ua3gs/ZVWx6oOypYoCJhGGScy+8" crossorigin="anonymous"></script>
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
		<style type="text/css">
			#leaderboard li {
				font-family: sans-serif;
				font-size: 15px;
				line-height: 50px;
			}
			#leaderboard #players li {
				display:block;
				clear: both;
				position: absolute;
				//width: 350px;
				-moz-transition-duration: 1s;
				-webkit-transition-duration: 1s;
				-ms-transition-duration: 1s;
				
				background-image: url(back_ground.jpg);
				background-repeat: no-repeat;
				/* background-position: right top; */
				/* background-attachment: fixed; */
				background-repeat: no-repeat;
				background-size: 300px 70px;
			}
			#leaderboard #players li.header {
				font-weight: bold;
				background-color: silver;
				background: -moz-linear-gradient(top, #cedce7 0%, #596a72 100%);
				background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#cedce7), color-stop(100%,#596a72));
			}
			#leaderboard #players {
				padding: 0px 0px 0px 0px;
				top: 50px;
				width: 650px;
				margin: 0 auto;
				position: relative;
				//border: 1px solid #333;
				//box-shadow: 2px 2px 5px gray;
				//height: 132px;
				background: -moz-linear-gradient(top, #cedce7 0%, #596a72 100%);
				background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#cedce7), color-stop(100%,#596a72));
			}
			#leaderboard #players div {
				display: block;
				float: left;
				overflow: hidden;
				padding: 5px;
				height: 70px;
			}
			#leaderboard .player {
				background: -moz-linear-gradient(top, #feffff 0%, #e0dace 100%);
				background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#feffff), color-stop(100%,#e0dace));
			}
			#leaderboard .rank {
				width: 50px;
				text-align: center;
			}
			#leaderboard .player > .rank {
				background-image: url(border_bg.jpg);
				background-repeat: no-repeat;
				/* background-position: right top; */
				/* background-attachment: fixed; */
				background-repeat: no-repeat;
				background-size: 50px 70px;
			}
			#leaderboard .name {
				width: 250px;
			}
			#leaderboard .score {
				font-size: 20px;
				width: 100px;
				text-align: center;
			}
			#leaderboard .star {
				font-size: 20px;
				width: 100px;
				text-align: center;
			}
			#leaderboard .cards {
				font-size: 20px;
				width: 100px;
				text-align: center;
			}
			#leaderboard .playerImg {
				width: 50px;
				text-align: center;
			}
			#leaderboard .scoreImg {
				width: 20px;
				text-align: center;
			}
			#leaderboard .starImg {
				width: 20px;
				text-align: center;
			}
			#leaderboard .cardImg {
				width: 20px;
				text-align: center;
			}
		</style>
	</head>
	
	<body>

	<div id="leaderboard">
		<ul id="players">
			<li class="header">
				<div class="rank">Rank</div>
				<div class="name">Player</div>
				<div class="score">Score</div>
				<div class="star">Star</div>
				<div class="cards">Card</div>
			</li>
		</ul>
	</div>

	<script language="javascript">
		var players;
		var timerId;
		var scoreToWin = 2000;
		var updateInterval = 2000;

		//昇冪排序
		function ascension(a, b) 	{ return (a.score == b.score && a.star > b.star) ? 1 : ( a.score > b.score ? 1 : -1); }
		//降冪排序，以 score先排序，然後是 star
		function descending(a, b) { return (a.score == b.score && a.star < b.star) ? 1 : ( a.score < b.score ? 1 : -1); }
		
		//調整相對高度...y為標題欄位的高度。(這邊應該可以調整，除了標題以外，還有各個欄位的高度)
		function reposition() {
			var height = $("#leaderboard .header").height();
			var y = height;
			for(var i = 0; i < players.length; i++) {
				players[i].$item.css("top", y + "px");
				y += height;			
			}
		}
		//更新排名版
		function updateBoard() {
			var player = getRandomPlayer();	
			player.score += 100;		//player.score += getRandomScoreIncrease();
			player.$item.find(".score > span").text(player.score);
			
			players.sort(descending);				//根據昇冪或降冪進行排序，descending為降冪
			updateRanks(players);
			reposition();
			
			if(isGameOver(player.score)) {
				resetBoard();	
			}
		}
		
		//判斷比賽是否結束
		function isGameOver(score) {
			return score >= scoreToWin;
		}
		//隨機選擇一名
		function getRandomPlayer() {
			var index = getRandomBetween(0, players.length);
			return players[index];
		}
		//隨機生成一個介於 50~150之間的點數
		function getRandomScoreIncrease() {
			return getRandomBetween(50, 150);
		}
		//隨機生成一個介於 N~M之間的點數
		function getRandomBetween(minimum, maximum) {
			 return Math.floor(Math.random() * maximum) + minimum;
		}
		
		//更新名次
		function updateRanks(players) {
			for(var i = 0; i < players.length; i++) {
				players[i].$item.find(".rank").text(i + 1);	
			}
		}

		//重設排名版
		function resetBoard() {
			var $list = $("#players");
			
			$list.find("li.player").remove();
			if(timerId !== undefined) {
				clearInterval(timerId);
			}
			
			players = [
				{ name: "D35truXion", score: 500, star: 5, card: 2, image: "head_icon.jpg", scoreImage: "blood.png", starImage: "star.png", cardImage: "card-game.png" },
				{ name: "Lithos", score: 400, star: 1, card: 3, image: "Perry_the_platypus.png", scoreImage: "blood.png", starImage: "star.png", cardImage: "card-game.png" },
				{ name: "baby.bumpkins", score: 300, star: 2, card: 4, image: "head_icon.jpg", scoreImage: "blood.png", starImage: "star.png", cardImage: "card-game.png" },
				{ name: "SpreadsheetMan", score: 200, star: 3, card: 6, image: "Perry_the_platypus.png", scoreImage: "blood.png", starImage: "star.png", cardImage: "card-game.png" },
				{ name: "Eitz", score: 100, star: 4, card: 8, image: "head_icon.jpg", scoreImage: "blood.png", starImage: "star.png", cardImage: "card-game.png" }
			];
			for(var i = 0; i < players.length; i++) {
				var $item = $(
					"<li class='player'>" + 
						"<div class='rank'>" + (i + 1) + "</div>" + 
						"<div class='name'>" + 
							"<img class='playerImg' src=\""+players[i].image+"\" alt=\""+players[i].name+"\">" + 
							"<span>" + players[i].name + "</span>" +
						"</div>" +
						"<div class='score'>" + 
							"<img class='scoreImg' src=\""+players[i].scoreImage+"\" alt=\""+players[i].score+"\">" + 
							"<span>" + players[i].score + "</span>" +
						"</div>" +
						"<div class='star'>" + 
							"<img class='starImg' src=\""+players[i].starImage+"\" alt=\""+players[i].star+"\">" + 
							"<span>" + players[i].star + "</span>" + 
						"</div>" +
						"<div class='cards'>"  + 
							"<img class='cardImg' src=\""+players[i].cardImage+"\" alt=\""+players[i].card+"\">" + 
							"<span>" + players[i].card + "</span>" + 
						"</div>" +
					"</li>");
				players[i].$item = $item;
				$list.append($item);
			}
			
			timerId = setInterval("updateBoard();", updateInterval);
			
			reposition();
		}	
		
		resetBoard();
	</script>
	</body>
</html>